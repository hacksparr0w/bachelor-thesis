variable target_temperature getenv "MD_TARGET_TEMPERATURE"
variable volume_scale getenv "MD_VOLUME_SCALE"
variable model getenv "MD_DEEPMD_MODEL"

units metal
atom_style atomic
boundary p p p

variable size_scale equal ${volume_scale}^(1/3)

read_data ml4md/amorphous_structure.dat

pair_style deepmd ${model}
pair_coeff * *
neigh_modify every 1 check yes
mass 1 28.08

fix 1 all nvt temp 1 ${target_temperature} 0.01
timestep 0.001

thermo 100
thermo_style custom step temp pe etotal press vol
run 5000
unfix 1

fix 2 all nve
fix 3 all deform 10 &
  x scale ${size_scale} &
  y scale ${size_scale} &
  z scale ${size_scale} &
  remap x &
  remap v &
  units box

run 5000

unfix 3

min_style cg
minimize 1e-15 1e-15 1000 10000
